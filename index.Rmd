[![Travis-CI Build Status](https://travis-ci.org/JohnCoene/sigmajs.svg?branch=master)](https://travis-ci.org/JohnCoene/sigmajs) [![AppVeyor Build Status](https://ci.appveyor.com/api/projects/status/github/JohnCoene/sigmajs?branch=master&svg=true)](https://ci.appveyor.com/project/JohnCoene/sigmajs)  [![bitbucket](https://img.shields.io/bitbucket/pipelines/JohnCoene/sigmajs.svg)](https://bitbucket.org/JohnCoene/sigmajs) [![CircleCI](https://img.shields.io/circleci/project/github/JohnCoene/sigmajs.svg)](https://github.com/JohnCoene/sigmajs) [![lifecycle](https://img.shields.io/badge/lifecycle-stable-brightgreen.svg)](https://www.tidyverse.org/lifecycle/#stable) [![CRAN status](https://www.r-pkg.org/badges/version/sigmajs)](https://cran.r-project.org/package=sigmajs) [![Coverage status](https://codecov.io/gh/JohnCoene/sigmajs/branch/master/graph/badge.svg)](https://codecov.io/github/JohnCoene/sigmajs?branch=master) [![Coverage status](https://coveralls.io/repos/github/JohnCoene/sigmajs/badge.svg)](https://coveralls.io/r/JohnCoene/sigmajs?branch=master)


```{r, eval=TRUE, echo = FALSE}
library(htmltools)
library(sigmajs)

# ----------------------------- GET STARTED
nodes_demo <- sg_make_nodes()
edges_demo <- sg_make_edges(nodes_demo, 17)

nodes_demo$size <- 1

get_started <- sigmajs(height = 150) %>% 
  sg_nodes(nodes_demo, id, color, size) %>% 
  sg_edges(edges_demo, id, source, target) %>% 
  sg_settings(defaultNodeColor = "#98D3A5",
              mouseEnabled = FALSE,
	            touchEnabled = FALSE,
              minNodeSize = 3,
              maxNodeSize = 3) %>% 
  sg_layout()

# ----------------------------- DYNAMIC
edges_demo$delay <- runif(nrow(edges_demo), 500, 1000) # between .5 and 2 seconds

last_edge <- sum(edges_demo$delay) + 100

dyn <- sigmajs(height = 150) %>%
  sg_force_start() %>%
  sg_nodes(nodes_demo, id, size, color) %>%
  sg_add_edges(edges_demo, delay, id, source, target) %>% # read delay documentation
  sg_force_stop(last_edge) %>% 
  sg_settings(mouseEnabled = FALSE,
	            touchEnabled = FALSE,
              minNodeSize = 1,
              maxNodeSize = 4)

# ----------------------------- ANIMATE
n <- nrow(nodes_demo)
layout <- sg_get_layout(nodes_demo, edges_demo)
nodes_demo$to_x <- layout$x
nodes_demo$to_y <- layout$y
nodes_demo$to_size <- runif(n, 5, 10)
nodes_demo$color <- sample(c("#ffe66d", "#e85d75"), n, replace = TRUE)
nodes_demo$to_color <- sample(c("#B1E2A3", "#98D3A5", "#328983", "#1C5C70",
  "#24C96B"), n, replace = TRUE)

animate <- sigmajs(height = 150) %>%
  sg_nodes(nodes_demo, id, label, size, color, to_x, to_y, to_size, to_color) %>%
  sg_edges(edges_demo, id, source, target) %>% 
  sg_animate(mapping = list(x = "to_x", y = "to_y", size = "to_size", color = "to_color"),
             delay = 500) %>%
  sg_settings(animationsTime = 10000,
              minNodeSize = 1,
              maxNodeSize = 5,
              mouseEnabled = FALSE,
	            touchEnabled = FALSE)

br()
div(
  class = "row",
  div(
    class = "col-md-8",
    h2(a("sigmajs", href = "http://sigmajs.org/", target = "_blank"), "for R"),
    "With the rise in popularity of networks, it is important for R users to have access to a package that allows visualising the aforementioned networks in a highly configurable, interactive and dynamic manner. `sigmajs` leverages the", a("original library's", href = "http://sigmajs.org/", target = "_blank"), "great many methods by providing numerous proxies, buttons, and more."
  ),
  div(
    class = "col-md-4",
    img(
      src = "man/figures/logo.png",
      class = "img-responsive",
      style = "margin:0 auto;max-height:150px;"
    )
  )
)
br()

div(
  class = "row",
  div(
    class = "col-md-4",
    div(
      class = "thumbnail",
      div(
        class = "caption",
        h3("Get Started"),
        get_started,
        p("Get started with", code("sigmajs"), ", draw your first graphs and learn about settings."),
        p(
          a(
            href = "articles/get_started.html",
            class = "btn btn-primary",
            tags$i(class = "fa fa-rocket"),
            "Start"
          ),
          a(
            href = "articles/layout.html",
            class = "btn btn-success",
            tags$i(class = "fa fa-cubes"),
            "Layouts"
          )
        )
      )
    )
  ),
  div(
    class = "col-md-4",
    div(
      class = "thumbnail",
      div(
        class = "caption",
        h3("Dynamism"),
        dyn,
        p("Learn how to make a temporal graph in static R markdown documents."),
        p(
          a(
            href = "articles/dynamic.html",
            class = "btn btn-primary",
            tags$i(class = "fa fa-spinner fa-pulse fa-fw"),
            "Dynamic"
          ),
          a(
            href = "articles/buttons.html",
            class = "btn btn-success",
            tags$i(class = "fa fa-gavel"),
            "Buttons"
          )
        )
      )
    )
  ),
  div(
    class = "col-md-4",
    div(
      class = "thumbnail",
      div(
        class = "caption",
        h3("Animate"),
        animate,
        p("Animate the color, size, and x/y coordinates of the nodes on the canvas."),
        p(
          a(
            href = "articles/animate.html",
            class = "btn btn-primary",
            tags$i(class = "fa fa-cogs"),
            "Animate"
          )
        )
      )
    )
  )
)

div(
  class = "row",
  div(
    class = "col-md-4",
    div(
      class = "thumbnail",
      div(
        class = "caption",
        h3("Shiny"),
        p("Explore the package's proxies and learn how to capture user interactions."),
        p(
          a(
            href = "articles/shiny.html",
            class = "btn btn-primary",
            tags$i(class = "fa fa-graduation-cap"),
            "Guide"
          ),
          a(
            href = "http://shiny.john-coene.com/sigmajs/",
            target = "_blank",
            class = "btn btn-success",
            tags$i(class = "fa fa-desktop"),
            "Demo"
          )
        )
      )
    )
  ),
  div(
    class = "col-md-4",
    div(
      class = "thumbnail",
      div(
        class = "caption",
        h3("Crosstalk"),
        p("Have", code("sigmajs"), "play hand-in-hand with other", 
          a("htmlwidgets,", href = "https://rstudio.github.io/crosstalk/widgets.html", target = "_blank"),
          "highlight nodes and neighbours on click."
        ),
        p(
          a(
            href = "articles/talkcross.html",
            class = "btn btn-primary",
            tags$i(class = "fa fa-exchange"),
            "Crosstalk"
          )
        )
      )
    )
  ),
  div(
    class = "col-md-4",
    div(
      class = "thumbnail",
      div(
        class = "caption",
        h3("Formats"),
        p("Build", code("sigmajs"), "graphs from igraph objects or GEXF files in a single function call."),
        p(
          a(
            href = "articles/formats.html#igraph",
            class = "btn btn-primary",
            tags$i(class = "fa fa-share-alt"),
            "igraph"
          ),
          a(
            href = "articles/formats.html#gexf",
            target = "_blank",
            class = "btn btn-success",
            tags$i(class = "fa fa-file-code-o"),
            "GEXF"
          )
        )
      )
    )
  )
)
```

## Install

```{r, eval = FALSE}
# install.packages("devtools")
devtools::install_github("JohnCoene/sigmajs") # github
devtools::install_bitbucket("JohnCoene/sigmajs") # bitbucket
```

## Examples

Most functions have corresponding `demo()`.

*Note that the graphs may not work in RStudio viewer, open them in the browser of your choice.*

```{r, eval=TRUE}
library(sigmajs)

# generate data
nodes <- sg_make_nodes(25) # 20 nodes
edges <- sg_make_edges(nodes, 50) # 50 edges

sigmajs() %>% # initialise
  sg_nodes(nodes, id, label, size, color) %>% # add nodes
  sg_edges(edges, id, source, target) %>% # add edges
  sg_layout() %>%  # layout
  sg_neighbours() # show node neighbours on node click
```

Most functions have corresponding demos, execute the command in the `run` column to see sigmajs in action. You can also see some of these examples [here](http://shiny.john-coene.com/sigmajs/).

```{r, eval = TRUE, echo = FALSE}
demos <- readLines("./demo/00Index")
demos <- strsplit(demos, "\t+|([[:space:]]){3}")
demos <- demos[lapply(demos, length) > 1]
df <- data.frame()
for(i in 1:length(demos)){
	row <- data.frame(
		name = paste0("`", trimws(demos[[i]][1]), "`"), 
		run = paste0("`demo(", trimws(demos[[i]][1]), ", package='sigmajs')`")
	)
	df <- rbind.data.frame(df, row)
}

knitr::kable(df, caption = "sigmajs demos", format = "html")
```
